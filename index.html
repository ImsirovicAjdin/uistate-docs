<html lang="en" data-theme="dark"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UIstate — Path-based state management for the web</title>
  <link rel="stylesheet" href="style.css">
  <script src="theme.js"></script>
  <style>
    /* ── Hero overrides ── */
    .hero { padding: 2rem 0 1rem; }
    .hero .tagline {
      font-size: 1.15rem; max-width: 600px; margin-left: auto;
      margin-right: auto; line-height: 1.5;
    }

    /* ── Step buttons ── */
    .hero-steps {
      display: none; justify-content: center; gap: 10px;
      margin: 0 auto 0; max-width: 820px;
    }
    .hero-step-btn {
      flex: 1; padding: 8px 10px; border-radius: 8px;
      border: 1px solid var(--border); background: var(--bg-secondary);
      color: var(--text-muted); font-size: 12px; font-weight: 600;
      font-family: system-ui, sans-serif; cursor: pointer;
      text-align: center; transition: all 0.15s; line-height: 1.35;
    }
    .hero-step-btn:hover { border-color: var(--accent); color: var(--text); }
    .hero-step-btn.active {
      border-color: var(--accent); background: var(--accent);
      color: #fff;
    }
    .hero-step-btn .step-num {
      display: block; font-size: 10px; opacity: 0.7;
      margin-bottom: 2px; font-weight: 400;
    }

    /* ── Interactive Hero Demo ── */
    .hero-demo {
      display: flex; gap: 0; border-radius: 12px; overflow: hidden;
      margin: 0.75rem auto 0; max-width: 820px;
      font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
      font-size: 13px; line-height: 1.6;
    }
    [data-theme="dark"]  .hero-demo { box-shadow: 0 0 12px 4px rgb(96 165 250 / 0.20); }
    [data-theme="light"] .hero-demo { box-shadow: 0 0 12px 4px rgb(59 130 246 / 0.28); }

    /* ── Theme-aware code panel ── */
    .hero-code {
      flex: 1; padding: 0; min-width: 0;
      display: flex; flex-direction: column;
    }
    [data-theme="dark"] .hero-code  { background: #0f172a; color: #e2e8f0; }
    [data-theme="light"] .hero-code { background: #f1f5f9; color: #1e293b; }
    .hero-code-header {
      padding: 8px 16px; font-size: 11px; font-weight: 700; color: var(--text-muted);
      border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 8px;
      font-family: system-ui, sans-serif; text-transform: uppercase; letter-spacing: 0.05em;
    }
    .hero-code-header .dot { width: 8px; height: 8px; border-radius: 50%; }
    .hero-code-header .dot.r { background: #ef4444; }
    .hero-code-header .dot.y { background: #eab308; }
    .hero-code-header .dot.g { background: #22c55e; }
    .hero-code-body { padding: 12px 0; overflow-x: auto; flex: 1; }
    .hero-code-body .cl {
      display: block; padding: 0 16px 0 0; white-space: pre;
      transition: opacity 0.25s;
    }
    .hero-code-body .cl.dimmed { opacity: 0.25; }
    .hero-code-body .ln {
      display: inline-block; width: 32px; text-align: right;
      color: var(--text-muted); opacity: 0.4; padding-right: 12px; user-select: none;
      border-right: 1px solid var(--border); margin-right: 12px;
    }
    /* Dark syntax colors */
    [data-theme="dark"] .hero-code-body .kw { color: #c084fc; }
    [data-theme="dark"] .hero-code-body .fn { color: #60a5fa; }
    [data-theme="dark"] .hero-code-body .st { color: #34d399; }
    [data-theme="dark"] .hero-code-body .cm { color: #475569; }
    [data-theme="dark"] .hero-code-body .nb { color: #f59e0b; }
    [data-theme="dark"] .hero-code-body .op { color: #94a3b8; }
    [data-theme="dark"] .hero-code-body .pr { color: #f472b6; }

    [data-theme="light"] body { background-color: #f2f4f5; }
    /* Light syntax colors */
    [data-theme="light"] .hero-code-body .kw { color: #7c3aed; }
    [data-theme="light"] .hero-code-body .fn { color: #2563eb; }
    [data-theme="light"] .hero-code-body .st { color: #059669; }
    [data-theme="light"] .hero-code-body .cm { color: #94a3b8; }
    [data-theme="light"] .hero-code-body .nb { color: #d97706; }
    [data-theme="light"] .hero-code-body .op { color: #64748b; }
    [data-theme="light"] .hero-code-body .pr { color: #db2777; }

    /* ── Live panel (right) ── */
    .hero-live {
      width: 310px; flex-shrink: 0;
      background: var(--bg-secondary);
      display: flex; flex-direction: column;
      border-left: 1px solid var(--border);
    }
    .hero-live-header {
      padding: 8px 16px; font-size: 11px; font-weight: 700; color: var(--text-muted);
      border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 8px;
      font-family: system-ui, sans-serif; text-transform: uppercase; letter-spacing: 0.05em;
    }
    .hero-live-header .live-dot {
      width: 6px; height: 6px; border-radius: 50%; background: #34d399;
      animation: livePulse 2s ease-in-out infinite;
    }
    @keyframes livePulse { 0%,100%{opacity:1} 50%{opacity:0.4} }

    .hero-app {
      padding: 0px 20px 16px; display: flex; flex-direction: column;
      align-items: center; gap: 12px;
    }
    .hero-app-label {
      font-size: 11px; color: var(--text-muted); font-family: system-ui, sans-serif;
      text-transform: uppercase; letter-spacing: 0.08em; font-weight: 600;
    }
    .hero-counter {
      font-size: 48px; font-weight: 800; color: var(--text);
      font-variant-numeric: tabular-nums; transition: color 0.15s;
      font-family: system-ui, sans-serif;
    }
    .hero-counter.flash { color: #34d399; }
    .hero-btn {
      width: 44px; height: 44px; border-radius: 10px; border: 1px solid var(--border);
      background: var(--bg); color: var(--text); font-size: 20px; font-weight: 700;
      cursor: pointer; display: flex; align-items: center; justify-content: center;
      transition: all 0.12s; font-family: system-ui, sans-serif; line-height: 1;
    }
    .hero-btn:hover { background: var(--accent); border-color: var(--accent); color: #fff; }
    .hero-btn:active { transform: scale(0.95); }

    .hero-state {
      border-top: 1px solid var(--border); padding: 16px 20px; flex: 1;
    }
    .hero-state-label {
      font-size: 10px; color: var(--text-muted); font-family: system-ui, sans-serif;
      text-transform: uppercase; letter-spacing: 0.08em; font-weight: 700;
      margin-bottom: 8px;
    }
    .hero-tree { font-size: 13px; color: var(--text-muted); line-height: 2; }
    .hero-tree .brace { color: var(--text-muted); }
    .hero-tree .key { color: var(--accent); }
    .hero-tree .val { color: #f59e0b; transition: color 0.15s; }
    .hero-tree .val.flash { color: #34d399; }
    .hero-tree .indent { padding-left: 20px; display: block; }

    /* CTA below demo */
    .hero-demo-cta {
      text-align: center; margin: 3rem auto 0; max-width: 820px;
      font-family: system-ui, sans-serif;
    }
    .hero-demo-cta p { color: var(--text-muted); font-size: 14px; margin-bottom: 10px; }
    .hero-demo-cta a {
      display: inline-block; padding: 8px 20px; background: var(--accent);
      color: #fff; border-radius: 8px; text-decoration: none;
      font-size: 16px; font-weight: 600; transition: background 0.15s;
    }
    .hero-demo-cta a:hover { background: var(--accent-hover); color: #fff; text-decoration: none; }

    /* ── Navbar extras ── */
    .nav-install {
      display: inline-flex; align-items: center; gap: 6px;
      background: var(--code-block-bg); color: var(--code-block-text);
      padding: 4px 10px; border-radius: 6px;
      font-family: 'SF Mono', 'Fira Code', monospace; font-size: 12px;
    }
    .nav-install .copy-btn { position: static; padding: 2px 6px; font-size: 10px; }
    .nav-get-started {
      display: inline-block; padding: 4px 14px; background: var(--accent);
      color: #fff !important; border-radius: 6px; font-size: 13px;
      font-weight: 600; text-decoration: none !important;
    }
    .nav-get-started:hover { background: var(--accent-hover); }

    /* Theme tweaks */
    [data-theme="light"] .hero-demo { box-shadow: 0 8px 32px rgba(0,0,0,0.10); }

    /* Responsive */
    @media (max-width: 700px) {
      .hero-demo { flex-direction: column; }
      .hero-live { width: 100%; border-left: none; border-top: 1px solid var(--border); }
      .hero-app { padding: 16px; flex-direction: row; flex-wrap: wrap; justify-content: center; }
      .hero-counter { font-size: 36px; }
      .hero-steps { flex-direction: column; }
    }
    @media (max-width: 768px) {
      .nav-install { display: none; }
      .nav-get-started { display: none; }
    }
  </style>
</head>
<body>

<header class="site-header">
  <a href="/" class="logo">UIstate</a>
  <nav>
    <a href="core.html">Core</a>
    <a href="css.html">CSS</a>
    <a href="react.html">React</a>
    <a href="event-test.html">Event Test</a>
  </nav>
  <div class="header-right">
    <span class="nav-install">npm i @uistate/core <button class="copy-btn" onclick="__copy('npm install @uistate/core', this)">Copy</button></span>
    <a href="core.html" class="nav-get-started">Get Started</a>
    <a href="https://github.com/ImsirovicAjdin/uistate/stargazers" class="star-link">★ Star</a>
    <button id="theme-toggle" onclick="__toggleTheme()" aria-label="Switch to dark theme">☾</button>
  </div>
</header>

<main class="main landing">
  <div class="hero">
    <h1>UIstate</h1>
    <p class="tagline">Path-based state management with wildcard subscriptions, async support, and state-driven CSS.</p>
    <p>Click the button. Watch the state update. That's the whole API.</p>
  </div>

  <!-- ═══ Step Buttons ═══ -->
  <div class="hero-steps">
    <button class="hero-step-btn" data-step="0" id="stepBtn0"><span class="step-num">Step 1</span>Create Store</button>
    <button class="hero-step-btn" data-step="1" id="stepBtn1"><span class="step-num">Step 2</span>Subscribe to Changes</button>
    <button class="hero-step-btn" data-step="2" id="stepBtn2"><span class="step-num">Step 3</span>Update State</button>
  </div>

  <!-- ═══ Interactive Hero Demo ═══ -->
  <div class="hero-demo">
    <!-- Code panel -->
    <div class="hero-code">
      <div class="hero-code-header">
        <span class="dot r"></span><span class="dot y"></span><span class="dot g"></span>
        <span style="margin-left: 4px">app.js</span>
      </div>
      <div class="hero-code-body" id="heroCodeBody"></div>
    </div>
    <!-- Live panel -->
    <div class="hero-live">
      <div class="hero-live-header">
        <span class="live-dot"></span> Live Preview
      </div>
      <div class="hero-app">
        <!-- <div class="hero-app-label">Counter App</div> -->
        <div class="hero-counter" id="heroCount">0</div>
        <button class="hero-btn" id="heroIncBtn"><span style="padding-bottom: 4px">+</span></button>
      </div>
      <div class="hero-state">
        <div class="hero-state-label">State Tree</div>
        <div class="hero-tree" id="heroTree"></div>
      </div>
    </div>
  </div>
  <div class="hero-demo-cta">
    <a href="dev-history-standalone-001.html">See a live app built in 60 seconds →</a>
  </div>
  <!-- ═══ End Hero Demo ═══ -->

  <div class="features">
    <div class="feature-card">
      <h3>@uistate/core</h3>
      <p>Reactive store with path-based get/set/subscribe, wildcard listeners, async operations, and query client. ~6 KB, zero dependencies.</p>
    </div>
    <div class="feature-card">
      <h3>@uistate/css</h3>
      <p>State-driven CSS — write styles as state paths, compile to real CSS rules. Reactive design tokens, typed validation, WCAG contrast enforcement.</p>
    </div>
    <div class="feature-card">
      <h3>@uistate/event-test</h3>
      <p>Event-sequence testing for UIstate stores. Trigger state changes and assert values, types, and event firings in a chainable API.</p>
    </div>
    <div class="feature-card">
      <h3>@uistate/examples</h3>
      <p>Working examples: counters, dashboards, async patterns, data tables. Each example is a standalone HTML file.</p>
    </div>
  </div>

  <h2>Ecosystem</h2>
  <table>
    <thead>
      <tr><th>Package</th><th>Version</th><th>Description</th></tr>
    </thead>
    <tbody>
      <tr>
        <td><a href="core.html">@uistate/core</a></td>
        <td><span class="version-badge">5.6.1</span></td>
        <td>Path-based state management</td>
      </tr>
      <tr>
        <td><a href="https://www.npmjs.com/package/@uistate/renderer">@uistate/renderer</a></td>
        <td><span class="version-badge">1.0.0</span></td>
        <td>Direct-binding reactive renderer</td>
      </tr>
      <tr>
        <td><a href="react.html">@uistate/react</a></td>
        <td><span class="version-badge">1.0.0</span></td>
        <td>React adapter hooks</td>
      </tr>
      <tr>
        <td><a href="css.html">@uistate/css</a></td>
        <td><span class="version-badge">1.0.0</span></td>
        <td>CSS-native state via custom properties</td>
      </tr>
      <tr>
        <td><a href="event-test.html">@uistate/event-test</a></td>
        <td><span class="version-badge">1.0.0</span></td>
        <td>Event-sequence testing</td>
      </tr>
      <tr>
        <td><a href="https://www.npmjs.com/package/@uistate/examples">@uistate/examples</a></td>
        <td><span class="version-badge">1.0.0</span></td>
        <td>Example applications</td>
      </tr>
      <tr>
        <td><a href="https://www.npmjs.com/package/@uistate/aliases">@uistate/aliases</a></td>
        <td><span class="version-badge">1.0.0</span></td>
        <td>DOM aliases for vanilla JS</td>
      </tr>
    </tbody>
  </table>

  <h2>Why UIstate?</h2>
  <ul>
    <li><strong>One primitive</strong> — <code>get</code>, <code>set</code>, <code>subscribe</code>. That's the whole API.</li>
    <li><strong>Path-based</strong> — nested state via dot paths: <code>user.profile.name</code></li>
    <li><strong>Wildcards</strong> — <code>user.*</code> fires on any child change, <code>*</code> fires on everything</li>
    <li><strong>Async built-in</strong> — <code>setAsync</code> manages loading/success/error states automatically</li>
    <li><strong>Framework-free</strong> — works in any browser, with any framework, or with none</li>
    <li><strong>Zero dependencies</strong> — ~6 KB total, pure JavaScript</li>
  </ul>

  <h2>License</h2>
  <p><code>@uistate/core</code> and <code>@uistate/css</code> are MIT licensed. <code>@uistate/event-test</code> has a proprietary license (free for personal/OSS use).</p>

</main>

<script>
function __copy(text, btn) {
  navigator.clipboard.writeText(text).then(function () {
    btn.textContent = 'Copied!';
    btn.classList.add('copied');
    setTimeout(function () { btn.textContent = 'Copy'; btn.classList.remove('copied'); }, 1500);
  });
}

// ═══════════════════════════════════════════════
// Interactive Hero Demo
// ═══════════════════════════════════════════════
(function() {
  // Mini reactive store
  function createMiniStore(initial) {
    var state = JSON.parse(JSON.stringify(initial));
    var subs = {};
    return {
      get: function(path) {
        return path.split('.').reduce(function(o, k) { return o && o[k]; }, state);
      },
      set: function(path, value) {
        var keys = path.split('.');
        var obj = state;
        for (var i = 0; i < keys.length - 1; i++) obj = obj[keys[i]];
        obj[keys[keys.length - 1]] = value;
        if (subs[path]) subs[path].forEach(function(fn) { fn(value); });
      },
      subscribe: function(path, fn) {
        if (!subs[path]) subs[path] = [];
        subs[path].push(fn);
      }
    };
  }

  var store = createMiniStore({ count: 0 });

  // Code lines with syntax highlighting — grouped into 3 steps
  // Step 0 (lines 0-4): import + createEventState
  // Step 1 (lines 5-8): subscribe
  // Step 2 (lines 9-13): onclick + store.set
  var codeLines = [
    '<span class="kw">import</span> { <span class="fn">createEventState</span> } <span class="kw">from</span> <span class="st">\'@uistate/core\'</span>;',
    '',
    '<span class="kw">const</span> store = <span class="fn">createEventState</span>({<span class="pr">count</span>: <span class="nb">0</span>});',
    '',
    'store.<span class="fn">subscribe</span>(<span class="st">\'count\'</span>, (<span class="pr">value</span>) <span class="kw">=&gt;</span> {',
    '  document.<span class="fn">getElementById</span>(<span class="st">\'num\'</span>).<span class="pr">textContent</span> = value;',
    '});',
    '',
    'document.<span class="fn">getElementById</span>(<span class="st">\'inc\'</span>).<span class="pr">onclick</span> = () <span class="kw">=&gt;</span> {',
    '  store.<span class="fn">set</span>(<span class="st">\'count\'</span>, store.<span class="fn">get</span>(<span class="st">\'count\'</span>) + <span class="nb">1</span>);',
    '};',
  ];

  // Line-to-step mapping
  var lineStep = [0,0,0,0,0, 1,1,1,1, 2,2,2,2];

  // Render code lines with data-step attribute
  var codeBody = document.getElementById('heroCodeBody');
  var codeHtml = '';
  for (var i = 0; i < codeLines.length; i++) {
    codeHtml += '<span class="cl" data-line-step="' + lineStep[i] + '"><span class="ln">' + (i + 1) + '</span>' + codeLines[i] + '</span>';
  }
  codeBody.innerHTML = codeHtml;

  // Step highlight logic
  var activeStep = -1; // -1 = show all, no dimming
  var stepBtns = [
    document.getElementById('stepBtn0'),
    document.getElementById('stepBtn1'),
    document.getElementById('stepBtn2')
  ];
  var allCodeLines = codeBody.querySelectorAll('.cl');

  function setActiveStep(step) {
    // Toggle: clicking the same step again deactivates it
    if (activeStep === step) {
      activeStep = -1;
    } else {
      activeStep = step;
    }

    // Update button states
    for (var b = 0; b < stepBtns.length; b++) {
      stepBtns[b].classList.toggle('active', b === activeStep);
    }

    // Dim/undim code lines
    for (var j = 0; j < allCodeLines.length; j++) {
      var ls = parseInt(allCodeLines[j].getAttribute('data-line-step'));
      if (activeStep === -1) {
        allCodeLines[j].classList.remove('dimmed');
      } else {
        allCodeLines[j].classList.toggle('dimmed', ls !== activeStep);
      }
    }
  }

  stepBtns.forEach(function(btn, idx) {
    btn.addEventListener('click', function() { setActiveStep(idx); });
  });

  // Render state tree
  function renderTree(count, flash) {
    var cls = flash ? 'val flash' : 'val';
    return '<span class="brace">{</span>' +
      '<span class="indent"><span class="key">"count"</span>: <span class="' + cls + '" id="treeVal">' + count + '</span></span>' +
      '<span class="brace">}</span>';
  }

  var treeEl = document.getElementById('heroTree');
  var countEl = document.getElementById('heroCount');
  treeEl.innerHTML = renderTree(0, false);

  function updateUI() {
    var val = store.get('count');
    countEl.textContent = val;
    treeEl.innerHTML = renderTree(val, true);
    countEl.classList.add('flash');
    setTimeout(function() {
      countEl.classList.remove('flash');
      var valSpan = document.getElementById('treeVal');
      if (valSpan) valSpan.classList.remove('flash');
    }, 300);
  }

  // + button handler
  document.getElementById('heroIncBtn').addEventListener('click', function() {
    store.set('count', store.get('count') + 1);
    updateUI();
  });
})();
</script>

</body></html>
